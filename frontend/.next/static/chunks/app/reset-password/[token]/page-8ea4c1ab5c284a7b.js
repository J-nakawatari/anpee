(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[878],{5196:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(19946).A)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},25731:(e,s,t)=>{"use strict";t.d(s,{Z:()=>o});var a=t(23464),r=t(57383);let c=t(49509).env.NEXT_PUBLIC_API_URL||"http://localhost:4003/api/v1",l=a.A.create({baseURL:c,withCredentials:!0,headers:{"Content-Type":"application/json"}});l.interceptors.request.use(e=>{let s=localStorage.getItem("accessToken");s&&(e.headers.Authorization="Bearer ".concat(s));let t=r.A.get("csrf-token");return t&&(e.headers["X-CSRF-Token"]=t),e},e=>Promise.reject(e)),l.interceptors.response.use(e=>e,async e=>{var s,t;let a=e.config;if((null==(s=e.response)?void 0:s.status)===401&&!a._retry&&!(null==(t=a.url)?void 0:t.includes("/auth/refresh"))){a._retry=!0;try{let{accessToken:e}=(await l.post("/auth/refresh")).data.data;return localStorage.setItem("accessToken",e),l(a)}catch(e){return localStorage.removeItem("accessToken"),window.location.href="/login",Promise.reject(e)}}return Promise.reject(e)});let o={login:async(e,s)=>(await l.post("/auth/login",{email:e,password:s})).data,register:async e=>(await l.post("/auth/register",e)).data,logout:async()=>{let e=await l.post("/auth/logout");return localStorage.removeItem("accessToken"),e.data},forgotPassword:async e=>(await l.post("/auth/forgot-password",{email:e})).data,resetPassword:async(e,s)=>(await l.post("/auth/reset-password",{token:e,password:s})).data}},32919:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(19946).A)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])},35695:(e,s,t)=>{"use strict";var a=t(18999);t.o(a,"useParams")&&t.d(s,{useParams:function(){return a.useParams}}),t.o(a,"useRouter")&&t.d(s,{useRouter:function(){return a.useRouter}})},43882:(e,s,t)=>{Promise.resolve().then(t.bind(t,84488))},84488:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>p});var a=t(95155),r=t(12115),c=t(35695),l=t(62177),o=t(90221),n=t(68309),i=t(25731),d=t(5196),m=t(51976),u=t(32919),h=t(51154);let x=n.Ik({password:n.Yj().min(8,"パスワードは8文字以上で入力してください").regex(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/,"パスワードは大文字・小文字・数字を含む必要があります"),confirmPassword:n.Yj().min(1,"パスワード（確認）を入力してください")}).refine(e=>e.password===e.confirmPassword,{message:"パスワードが一致しません",path:["confirmPassword"]});function p(){let e=(0,c.useParams)(),s=(0,c.useRouter)(),t=e.token,[n,p]=(0,r.useState)(!1),[f,w]=(0,r.useState)(""),[j,g]=(0,r.useState)(!1),{register:b,handleSubmit:y,formState:{errors:N}}=(0,l.mN)({resolver:(0,o.u)(x)}),v=async e=>{try{p(!0),w(""),(await i.Z.resetPassword(t,e.password)).success&&(g(!0),setTimeout(()=>{s.push("/login")},3e3))}catch(e){var a,r;w((null==(r=e.response)||null==(a=r.data)?void 0:a.message)||"パスワードのリセットに失敗しました。")}finally{p(!1)}};return j?(0,a.jsx)("div",{className:"min-h-screen warm-gradient flex items-center justify-center px-4",children:(0,a.jsx)("div",{className:"w-full max-w-md",children:(0,a.jsxs)("div",{className:"cute-card text-center",children:[(0,a.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-green-100 rounded-full mb-4",children:(0,a.jsx)(d.A,{className:"w-8 h-8 text-green-500"})}),(0,a.jsx)("h2",{className:"text-2xl font-bold text-peach-700 mb-4",children:"パスワードがリセットされました"}),(0,a.jsxs)("p",{className:"text-gray-600",children:["新しいパスワードでログインできます。",(0,a.jsx)("br",{}),"ログインページに移動します..."]})]})})}):(0,a.jsx)("div",{className:"min-h-screen warm-gradient flex items-center justify-center px-4",children:(0,a.jsx)("div",{className:"w-full max-w-md",children:(0,a.jsxs)("div",{className:"cute-card",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-peach-100 rounded-full mb-4",children:(0,a.jsx)(m.A,{className:"w-8 h-8 text-peach-500"})}),(0,a.jsx)("h1",{className:"text-2xl font-bold text-peach-700",children:"新しいパスワードを設定"}),(0,a.jsx)("p",{className:"text-gray-600 mt-2",children:"安全なパスワードを設定してください"})]}),f&&(0,a.jsx)("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 text-red-700 rounded-cute text-sm",children:f}),(0,a.jsxs)("form",{onSubmit:y(v),className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"新しいパスワード"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(u.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),(0,a.jsx)("input",{...b("password"),type:"password",id:"password",className:"w-full pl-10 pr-3 py-2 border border-peach-200 rounded-cute focus:outline-none focus:ring-2 focus:ring-peach-500",placeholder:"8文字以上、大文字・小文字・数字を含む",disabled:n})]}),N.password&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600",children:N.password.message})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"パスワード（確認）"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(u.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),(0,a.jsx)("input",{...b("confirmPassword"),type:"password",id:"confirmPassword",className:"w-full pl-10 pr-3 py-2 border border-peach-200 rounded-cute focus:outline-none focus:ring-2 focus:ring-peach-500",placeholder:"パスワードを再入力",disabled:n})]}),N.confirmPassword&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600",children:N.confirmPassword.message})]}),(0,a.jsx)("button",{type:"submit",disabled:n,className:"w-full cute-button disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:n?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h.A,{className:"w-4 h-4 mr-2 animate-spin"}),"設定中..."]}):"パスワードをリセット"})]})]})})})}}},e=>{e.O(0,[889,641,14,441,964,358],()=>e(e.s=43882)),_N_E=e.O()}]);