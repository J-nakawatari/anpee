(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[520],{9690:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>w});var a=t(95155),r=t(12115),l=t(35695),c=t(6874),o=t.n(c),i=t(62177),n=t(90221),d=t(68309),m=t(25731),u=t(51976),h=t(28883),x=t(32919),p=t(51154);let f=d.Ik({email:d.Yj().email("有効なメールアドレスを入力してください"),password:d.Yj().min(1,"パスワードを入力してください")});function w(){let e=(0,l.useRouter)(),[s,t]=(0,r.useState)(!1),[c,d]=(0,r.useState)(""),{register:w,handleSubmit:j,formState:{errors:g}}=(0,i.mN)({resolver:(0,n.u)(f)}),y=async s=>{try{t(!0),d("");let a=await m.Z.login(s.email,s.password);a.success&&(localStorage.setItem("accessToken",a.data.accessToken),localStorage.setItem("user",JSON.stringify(a.data.user)),e.push("/user/dashboard"))}catch(e){var a,r;d((null==(r=e.response)||null==(a=r.data)?void 0:a.message)||"ログインに失敗しました。もう一度お試しください。")}finally{t(!1)}};return(0,a.jsx)("div",{className:"min-h-screen warm-gradient flex items-center justify-center px-4",children:(0,a.jsxs)("div",{className:"w-full max-w-md",children:[(0,a.jsxs)("div",{className:"cute-card",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-peach-100 rounded-full mb-4",children:(0,a.jsx)(u.A,{className:"w-8 h-8 text-peach-500"})}),(0,a.jsx)("h1",{className:"text-2xl font-bold text-peach-700",children:"あんぴーちゃんにログイン"}),(0,a.jsx)("p",{className:"text-peach-600 mt-2",children:"大切な家族を見守りましょう"})]}),c&&(0,a.jsx)("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 text-red-700 rounded-cute text-sm",children:c}),(0,a.jsxs)("form",{onSubmit:j(y),className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"メールアドレス"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(h.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),(0,a.jsx)("input",{...w("email"),type:"email",id:"email",className:"w-full pl-10 pr-3 py-2 border border-peach-200 rounded-cute focus:outline-none focus:ring-2 focus:ring-peach-500",placeholder:"your@email.com",disabled:s})]}),g.email&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600",children:g.email.message})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"パスワード"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(x.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),(0,a.jsx)("input",{...w("password"),type:"password",id:"password",className:"w-full pl-10 pr-3 py-2 border border-peach-200 rounded-cute focus:outline-none focus:ring-2 focus:ring-peach-500",placeholder:"パスワード",disabled:s})]}),g.password&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600",children:g.password.message})]}),(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsx)(o(),{href:"/forgot-password",className:"text-sm text-peach-600 hover:text-peach-700",children:"パスワードを忘れた方"})}),(0,a.jsx)("button",{type:"submit",disabled:s,className:"w-full cute-button disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:s?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(p.A,{className:"w-4 h-4 mr-2 animate-spin"}),"ログイン中..."]}):"ログイン"})]}),(0,a.jsxs)("div",{className:"mt-6 text-center",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"まだアカウントをお持ちでない方は"}),(0,a.jsx)(o(),{href:"/register",className:"text-sm text-peach-600 hover:text-peach-700 font-medium",children:"新規登録はこちら"})]})]}),(0,a.jsx)("div",{className:"mt-8 text-center",children:(0,a.jsx)(o(),{href:"/",className:"text-sm text-peach-600 hover:text-peach-700",children:"トップページに戻る"})})]})})}},25731:(e,s,t)=>{"use strict";t.d(s,{Z:()=>o});var a=t(23464),r=t(57383);let l=t(49509).env.NEXT_PUBLIC_API_URL||"http://localhost:4003/api/v1",c=a.A.create({baseURL:l,withCredentials:!0,headers:{"Content-Type":"application/json"}});c.interceptors.request.use(e=>{let s=localStorage.getItem("accessToken");s&&(e.headers.Authorization="Bearer ".concat(s));let t=r.A.get("csrf-token");return t&&(e.headers["X-CSRF-Token"]=t),e},e=>Promise.reject(e)),c.interceptors.response.use(e=>e,async e=>{var s;let t=e.config;if((null==(s=e.response)?void 0:s.status)===401&&!t._retry){t._retry=!0;try{let{accessToken:e}=(await c.post("/auth/refresh")).data.data;return localStorage.setItem("accessToken",e),c(t)}catch(e){return localStorage.removeItem("accessToken"),window.location.href="/login",Promise.reject(e)}}return Promise.reject(e)});let o={login:async(e,s)=>(await c.post("/auth/login",{email:e,password:s})).data,register:async e=>(await c.post("/auth/register",e)).data,logout:async()=>{let e=await c.post("/auth/logout");return localStorage.removeItem("accessToken"),e.data},forgotPassword:async e=>(await c.post("/auth/forgot-password",{email:e})).data,resetPassword:async(e,s)=>(await c.post("/auth/reset-password",{token:e,password:s})).data}},28883:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(19946).A)("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]])},32919:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(19946).A)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])},35695:(e,s,t)=>{"use strict";var a=t(18999);t.o(a,"useParams")&&t.d(s,{useParams:function(){return a.useParams}}),t.o(a,"useRouter")&&t.d(s,{useRouter:function(){return a.useRouter}})},53354:(e,s,t)=>{Promise.resolve().then(t.bind(t,9690))}},e=>{e.O(0,[874,889,641,14,441,964,358],()=>e(e.s=53354)),_N_E=e.O()}]);